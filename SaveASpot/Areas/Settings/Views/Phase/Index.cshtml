@model SaveASpot.Areas.Settings.Models.PhaseList

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_LayoutDetailAdmin.cshtml";
}

@section SideBar {
    @Html.Partial("AdminMenu")
}

<div id="pad-wrapper">
    <div class="table-wrapper products-table section">
        <div class="row-fluid head">
            <div class="span12">
                <h4>Phases</h4>
            </div>
        </div>

        <div class="row-fluid filter-block">
            <div class="pull-right">
                <a href="@Url.Action("New")" class="btn-flat primary new-product">+ Add phase</a>
            </div>
        </div>

        <div class="row-fluid">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th class="span3">Phase</th>
                        <th class="span3">
                            <span class="line"></span>Price ($)
                        </th>
                        <th class="span3">
                            <span class="line"></span>Status
                        </th>
                        <th class="span3">
                            <span class="line"></span>Actions
                        </th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var phase in Model.Phases)
                    {
                    <tr>
                        <td>
                            <a href="@Url.Action("Edit", new { id = phase.PhaseID })" class="name">@phase.PhaseName</a>
                        </td>
                        <td class="description">
                            $&nbsp;@phase.SpotPrice
                        </td>
                        <td>
                            @if (phase.Complete)
                            {
                            <span class="label label-success">Complete</span>
                            }
                            else if (phase.Active)
                            {
                            <span class="label label-warning">Active</span>
                            }
                            else
                            {
                            <span class="label">Not Started</span>
                            }
                        </td>
                        <td>
                            <a href="@Url.Action("Edit", new { id = phase.PhaseID })" class="btn-flat white">Edit</a>
                            <a href="@Url.Action("Delete", new { id = phase.PhaseID })" class="btn-flat danger delete-phase">Delete</a>
                        </td>
                    </tr>
    
                    } 
                </tbody>
            </table>
        </div>
    </div>
</div>

<script id="phaseItem" type="text/html"><li>
    <a href="#{{ID}}" class="phase">                    
        <i class="icon-map-marker"></i>
        <span>{{PhaseName}}</span>
    </a>
</li> 
</script>

@section footer {
    <script src="/Scripts/mustache.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(function () {
            $(".delete-phase").click(function (event) {
                event.preventDefault();
                if (confirm("Are you sure you want to delete this phase?")) {
                    var button = $(this);
                    var url = button.attr("href");

                    $.post(url, null, function (result) {
                        if (result.success) {
                            button.parent().parent().remove();
                        }
                        else {
                            alert("there was an issue deleting");
                        }
                    }, "json");
                }
            });
        });
    </script>
}

