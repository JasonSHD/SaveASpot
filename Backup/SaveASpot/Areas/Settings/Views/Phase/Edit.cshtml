@model SaveASpot.Areas.Settings.Models.PhaseDetail

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_LayoutDetailAdmin.cshtml";
}

@section styles {
    <!-- this page specific styles -->
    <link rel="stylesheet" href="/Content/css/compiled/new-user.css" type="text/css" media="screen" />
}

@section SideBar {
    @Html.Partial("AdminMenu")
}

<div class="container-fluid">
    <div id="pad-wrapper" class="new-user">
        <div class="row-fluid header">
            <h3>Update phase</h3>
        </div>
        
        @if (ViewBag.Success)
        {
            <div class="alert alert-success">
                <i class="icon-ok-sign"></i> Your phase has been updated.
            </div>
        }
        @if(ViewBag.Error)
        {
            <div class="alert alert-error">
                <i class="icon-remove-sign"></i>
                Unable to save the phase.
            </div>
        }

        <div class="row-fluid form-wrapper">
            <!-- left column -->
            <div class="span9 with-sidebar">
                <div class="container">
                    @using (Html.BeginForm())
                    {
                        <div class="span12 field-box">
                            <label>Name:</label>
                            @Html.TextBoxFor(m => m.Phase.PhaseName, new { @class = "span9 " })
                        </div>                        
                        <div class="span12 field-box">
                            <label>Spot Price:</label>
                            <div class="input-prepend">
                                <span class="add-on"><i class="icon-usd"></i></span>
                                @Html.TextBoxFor(m => m.Phase.SpotPrice, new { @class = "span9" })
                            </div>
                        </div>                 
                        <div class="span12 field-box">
                            <label>Sponsor Price:</label>
                            <div class="input-prepend">
                                <span class="add-on"><i class="icon-usd"></i></span>
                                @Html.TextBoxFor(m => m.Phase.SponsorPrice, new { @class = "span9" })
                            </div>
                        </div>
                        <div class="field-box">
                            <label>Status:</label>
                            <label class="checkbox">
                                <div class="checker"><span>@Html.CheckBoxFor(m => m.Phase.Active)</span></div> Active
                            </label>
                            <label class="checkbox">
                                <div class="checker"><span>@Html.CheckBoxFor(m => m.Phase.Complete)</span></div> Complete
                            </label>
                        </div>

                        @Html.HiddenFor(m => m.Phase.PhaseID)
                        <div class="span11 field-box actions">
                            <input type="submit" class="btn-flat default" value="Update phase">
                            <span>OR</span> 
                            <input type="reset" value="Cancel" class="reset">
                        </div>
                    }

                    <hr />
                    <div class="row-fluid header">
                        <h3>Parcel Information</h3>
                    </div>
                    @using (Html.BeginForm("UploadPhase", "Phase", new { }, FormMethod.Post, new { enctype = "multipart/form-data", target = "loadFile" }))
                    {
                        <div class="span12 field-box">
                            <label>Upload Phase Shape File</label>
                            <input type="file" id="shapeFile" name="shapeFile" />
                            @Html.Hidden("id", Model.Phase.PhaseID)
                            <input type="submit" class="btn-flat default load-btn" value="Upload phase">
                            <img src="/Content/img/loader.gif" alt="Loading..." class="loader hide" />
                        </div>
                    }
                    
                    <hr />
                    <div class="row-fluid header">
                        <h3>Spot Information</h3>
                    </div>
                    @using (Html.BeginForm("UploadSpots", "Phase", new { }, FormMethod.Post, new { enctype = "multipart/form-data", target = "loadFile" }))
                    {
                        <div class="span12 field-box">
                            <label>Upload Spot Shape File</label>
                            <input type="file" id="shapeFile" name="shapeFile" />
                            @Html.Hidden("id", Model.Phase.PhaseID)
                            <input type="submit" class="btn-flat default load-btn" value="Upload spots">
                            <img src="/Content/img/loader.gif" alt="Loading..." class="loader hide" />
                        </div>
                    }
                    
                    <hr />
                    <div class="row-fluid header">
                        <h3>Sponsor Information</h3>
                    </div>
                    @using (Html.BeginForm("UploadSponsors", "Phase", new { }, FormMethod.Post, new { enctype = "multipart/form-data", target = "loadFile" }))
                    {
                        <div class="span12 field-box">
                            <label>Upload Sponsor Shape File</label>
                            <input type="file" id="shapeFile" name="shapeFile" />
                            @Html.Hidden("id", Model.Phase.PhaseID)
                            <input type="submit" class="btn-flat default load-btn" value="Upload sponsors">
                            <img src="/Content/img/loader.gif" alt="Loading..." class="loader hide" />
                        </div>
                    }

                    <iframe src="" style="display: none;" id="loadFile" name="loadFile"></iframe>
                </div>
            </div>
            <!-- side right column -->
            <div class="span3 form-sidebar pull-right">
                <div class="knobs">
                    <h6>User Spots - @Model.SpotInfo.Paid Paid / @Model.SpotInfo.Total</h6>
                    <div class="knob-wrapper">
                        <input type="text" value="@Model.SpotInfo.Percentage" class="knob" data-thickness=".3" data-inputColor="#333" data-fgColor="#30a1ec" data-bgColor="#d4ecfd" data-width="150" data-min="0" data-max="100">
                    </div>
                    <hr />
                    <h6>Sponsor Spots - @Model.SponsorInfo.Paid / @Model.SponsorInfo.Total</h6>
                    <div class="knob-wrapper">
                        <input type="text" value="@Model.SponsorInfo.Percentage" class="knob second" data-thickness=".3" data-inputColor="#333" data-fgColor="#3d88ba" data-bgColor="#d4ecfd" data-width="150" data-min="0" data-max="100">
                    </div>                        
                </div>
                <div class="alert alert-info hidden-tablet">
                    <i class="icon-lightbulb pull-left"></i>
                    Use the stats above to see where the current stats are for this phase.
                </div>
            </div>
        </div>
    </div>
</div>

@section footer {
<script src="/Scripts/js/jquery.knob.js" type="text/javascript"></script>
<script src="/Scripts/json2.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function () {
        // jQuery Knobs
        $(".knob").knob();

        $(".load-btn").click(function (event) {
            $(this).next().show();
        });

        $("#loadFile").load(function (data) {
            /*var result = $.parseJSON($(this).contents().text());
            if (result == null || !result.success) {
                // alert failure
                alert("There was an error trying to save the file.");
            }
            else {*/
                $(".loader").hide();
            //}
        });
    });
    </script>
}